### 令牌桶对性能的影响

每一万个令牌桶内存占用约为 8.2M，实际测试结果为<br>
164M / 20万 <br>
100M / 12万 <br>

令牌填充策略可选平滑或不平滑，平滑填充时会将填充策略转换成x纳秒填充1令牌，按照这个策略执行 <br>

性能相关测试，测试使用的API为一个简单的单表userId查询Demo服务，该API本身性能较好 <br>
测试20线程并发和单线程测试没有明显区别，以下描述为 20x500 的压测结果 <br>
不包含RateLimit组件时，对API进行测试，吞吐量115.02，94.4%的请求在1ms内返回，平均RT 0.84 <br>
包含RateLimit组件时 <br>
启动单个服务，吞吐量 125.77，93.4%的请求在1ms内返回，平均RT 0.92 <br>
本机启动2个服务，吞吐量 127.14，76.9%的请求在1ms内返回，平均RT 1.41 <br>
本机启动2个服务，拨号连接VPN模拟网络差的情况，会出现RT上升的情况，吞吐量正常，平均RT 128 <br>

结论：RateLimit本身对性能影响极小，更多的可能是测试偏差，测试中亦发生开启RateLimit且已经设置了保证不会被限流的填充策略时的压测结果好于未开启的情况。但是cache集群的网络状况对测试结果有影响，令牌桶会分布在各个服务节点上，当应用节点没持有对应令牌桶时会访问网络，此时网络状况会影响性能，应用到生产中时需要考虑该种情况。<br>

### Spring Spel表达式对性能的影响

常见的语法表达式有javascript表达式，ognl表达式，springSpel表达式。测试发现，ognl表达式性能最佳。该限流工具中使用的是springSPEL表达式。<br/>
工具中亦对已经解析过的表达式进行了缓存。实际情况下表达式并不能够对程序性能造成影响。<br/>